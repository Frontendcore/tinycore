(function(h){var f=true,l=false,k=null;var d=function(o,p){return Object.prototype.toString.call(o)==="[object "+p+"]"};var m=function(o){return d(o,"Function")};var e=function(p,q){var o;for(o in p){if(p.hasOwnProperty(o)){q(p[o],o)}}};var c=function(p,o){p=p||{};e(o,function(r,q){if(d(r,"Object")){r=c(p[q],r)}p[q]=r});return p};var b=function(o){return Array.prototype.slice.call(o)};var a=function(o,p,r){var q;if(o.__decorated__){return o}q=function(){try{return o.apply(p,b(arguments))}catch(s){g.ErrorHandler.log(r+s.message)}};q.__decorated__=f;return q};var i={log:function(o){h.console&&h.console.error(o)}};var j=(function(){var s={};var p=0;var o={};var r={};var q=function(t){var u=t;return{subscribe:function(A,w,x){var v=0,z,y;if(m(w)){A=d(A,"Array")?A:[A];for(z=A.length;v<z;v++){y=A[v];o[y]=o[y]||{};if(!o[y][u]){o[y][u]=g.debugMode?function(){w.apply(x,b(arguments))}:a(w,x,'Error publishing topic "'+y+'": ');r[u]=r[u]||[];r[u].push(y)}}}},publish:function(v,x){var w=o[v];if(w){h.setTimeout(function(){e(w,function(y){y({name:v,data:x})})},0)}},unSubscribe:function(x){var x=d(x,"Array")?x:[x],v=x.length,w;while(v--){w=o[x[v]];if(w&&w[u]){delete w[u]}}},unSubscribeAll:function(){if(r[u]){this.unSubscribe(r[u])}}}};return{build:function(t){return c(q(++p),s[t]||{})},register:function(u,t){if(!s[u]){s[u]=t;return f}return l}}}());var n=(function(){var p={};var o=function(q){if(!p[q]){throw new Error('Module "'+q+'" is not registered!')}};return{register:function(s,q,r){if(!p[s]){if(!m(q)){throw new Error('The creator of module "'+s+'" is not a function!')}p[s]={fpCreator:q,sSandBoxType:r||"",oInstance:k,bIsStarted:l};return f}return l},start:function(r,q){o(r);if(!p[r].bIsStarted){if(!p[r].oInstance){p[r].oInstance=this.instanciate(r)}p[r].oInstance.onStart(q);p[r].bIsStarted=f}},stop:function(q){o(q);if(p[q].bIsStarted&&p[q].oInstance){if(m(p[q].oInstance.onStop)){p[q].oInstance.onStop()}p[q].oInstance.__sandbox__.unSubscribeAll();p[q].bIsStarted=l}},instanciate:function(s){var r,q;o(s);r=j.build(p[s].sSandBoxType);q=p[s].fpCreator(r);if(!g.debugMode){e(q,function(u,t){if(m(u)){q[t]=a(u,q,'Error in module "'+s+'" executing method "'+t+'": ')}})}q.__sandbox__=r;return q},getModules:function(){return p}}}());var g={version:"0.4.0",debugMode:l,extend:function(o){c(this,o)},Module:n,SandBox:j,ErrorHandler:i};h.TinyCore=g;if(h.define){h.define("TinyCore",g)}}(this));