(function(k){var i=true,o=false,n=null;var f=function(q,r){return Object.prototype.toString.call(q)==="[object "+r+"]"};var p=function(q){return f(q,"Function")};var g=function(r,s){var q="";for(q in r){if(r.hasOwnProperty(q)){s(r[q],q)}}};var c=function(r,q){r=r||{};g(q,function(t,s){if(f(t,"Object")){t=c(r[s],t)}r[s]=t});return r};var b=function(q){return Array.prototype.slice.call(q)};var a=function(q,r,t){var s=n;if(q.__decorated__){return q}s=function(){try{q.apply(r,b(arguments))}catch(u){j.ErrorHandler.log(t+u.message)}};s.__decorated__=i;return s};var l={log:function(q){k.console&&k.console.error(q)}};var m=(function(){var u={};var r=0;var q={};var t={};var s=function(v){var w=v;return{subscribe:function(C,y,z){var B=0,x=0,A="";if(p(y)){C=f(C,"Array")?C:[C];for(B=C.length;x<B;x++){A=C[x];q[A]=q[A]||{};if(!q[A][w]){q[A][w]=j.debugMode?function(){y.apply(z,b(arguments))}:a(y,z,'Error publishing topic "'+A+'": ');t[w]=t[w]||[];t[w].push(A)}}}},publish:function(x,z){var y=q[x];if(y){k.setTimeout(function(){g(y,function(A){A({name:x,data:z})})},0)}},unSubscribe:function(z){var z=f(z,"Array")?z:[z],x=z.length,y=n;while(x--){y=q[z[x]];if(y&&y[w]){delete y[w]}}},unSubscribeAll:function(){if(t[w]){this.unSubscribe(t[w])}}}};return{build:function(v){return c(s(++r),u[v]||{})},register:function(w,v){if(!u[w]){u[w]=v;return i}return o}}}());var e={};var d=function(q){if(!e[q]){throw new Error('Module "'+q+'" is not registered!')}};var h=function(s){var r=m.build(e[s].sSandBoxType),q=e[s].fpCreator(r);if(!j.debugMode){g(q,function(u,t){if(p(u)){q[t]=a(u,q,'Error in module "'+s+'" executing method "'+t+'": ')}else{if(t==="topics"){g(u,function(v,w){r.subscribe(w,v,q)})}}})}q.__sandbox__=r;return q};var j={version:"0.2.0",debugMode:o,extend:function(q){c(this,q)},register:function(s,q,r){if(!e[s]){if(!p(q)){throw new Error('The creator of module "'+s+'" is not a function!')}e[s]={fpCreator:q,sSandBoxType:r||"",oInstance:n,bIsStarted:o};return i}return o},start:function(r,q){d(r);if(!e[r].bIsStarted){if(!e[r].oInstance){e[r].oInstance=this.instanciate(r)}e[r].oInstance.onStart(q);e[r].bIsStarted=i}},stop:function(q){d(q);if(e[q].bIsStarted&&e[q].oInstance){if(p(e[q].oInstance.onStop)){e[q].oInstance.onStop()}e[q].oInstance.__sandbox__.unSubscribeAll();e[q].bIsStarted=o}},instanciate:function(q){d(q);return h(q)},getModules:function(){return e},SandBox:m,ErrorHandler:l};k.TinyCore=j;if(k.define){define("TinyCore",j)}}(this));